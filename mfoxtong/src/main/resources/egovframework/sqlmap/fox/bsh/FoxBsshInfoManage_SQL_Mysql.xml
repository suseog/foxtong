<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="FoxBsshInfo">

    <typeAlias  alias="egovMap"      			type = "egovframework.rte.psl.dataaccess.util.EgovMap"/>
    <typeAlias  alias="foxBsshInfoDefaultVO" 	type = "egovframework.fox.bsh.service.FoxBsshInfoDefaultVO"/>
    <typeAlias  alias="foxEntrpsEmplyrSbscrbRequstVO" type = "egovframework.fox.bsh.service.FoxEntrpsEmplyrSbscrbRequstVO"/>
    <typeAlias  alias="foxBsshInfoManageVO"       type = "egovframework.fox.bsh.service.FoxBsshInfoManageVO"/>
    

    
    
   <insert id="foxBsshInfoManageDAO.insertBsshInfo" parameterClass="foxBsshInfoManageVO">
        <![CDATA[
            INSERT INTO FOXTNBSSHBASSINFO 
                (   
                    BSSH_ESNTL_ID         	,
                    BRTC_CODE 				,
                    SIGNGU_CODE				,
                    DONG_CODE         		,
                    MTLTY_NM    			,
                    BSSH_CMPGN_WORDS	    ,
                    BSSH_PHOTO_ID          	,
                    BSN_BEGIN_TIME     		,
                    BSN_END_TIME            ,
                    TLPHON_NO            	,
                    MOBLPHON_NO          	,
                    POST_NO       			,
                    ADRES    				,
                    DETAIL_ADRES        	,
                    BULD_NM      			,
                    BSN_STTUS      			,
                    COPRTN_STTUS			,
                    PREFER_CO    			,
                    POSTSCRIPT_CO     		,
                    FRST_REGISTER_ID		,
                    FRST_REGIST_PNTTM		,
                    CTGRY_ID        )
              VALUES(
                    #bsshEsntlId#,
                    #brtcCode#,
                    #signguCode#,
                    #dongCode#,
                    #mtltyNm#,
                    #bsshCmpgnWords#,
                    #bsshPhotoId#,
                    #bsnBeginTime#,
                    #bsnEndTime#,
                    #tlphonNo#,
                    #moblphonNo#,
                    #postNo#,
                    #adres#,
                    #detailAdres#,
                    #buldNm#,
                    '01',
                    '01',
                    '0',
                    '0',
                    #frstRegisterId#,
                    sysdate(),
                    #ctgryId#  )               
        ]]>
    </insert>
    
     <insert id="foxBsshInfoManageDAO.insertMberBsshMap" parameterClass="foxEntrpsEmplyrSbscrbRequstVO">
        <![CDATA[
            INSERT INTO FOXTNMBERBSSHMAPNG 
            (   
                     ESNTL_ID 				
                    ,BSSH_ESNTL_ID         	
                    ,SBSCRB_STTUS			
                    ,FRST_REGIST_PNTTM			
             )VALUES(
                     #esntlId#
                    ,#bsshEsntlId#
                    ,'01'
                    ,sysdate()
            )               
        ]]>
    </insert>
    
    <update id="foxBsshInfoManageDAO.updateSbscrbSttus" parameterClass="foxEntrpsEmplyrSbscrbRequstVO">
           <![CDATA[
	           UPDATE FOXTNMBERBSSHMAPNG 
	              SET   SBSCRB_STTUS 	= #sbscrbSttus#
	              	  , LAST_UPDT_PNTTM 	= sysdate()
	            WHERE 1=1
	              AND BSSH_ESNTL_ID=#bsshEsntlId#
           ]]>
    </update>
    
   	<select id="foxBsshInfoManageDAO.selectBsshEsntlIdList" parameterClass="java.lang.String" resultClass="egovMap">
       <![CDATA[
		       SELECT 	A.BSSH_ESNTL_ID  	AS    bsshEsntlId
		       		,	B.MTLTY_NM  		AS    mtltyNm
		         FROM	FOXTNMBERBSSHMAPNG 		AS A 
		                JOIN FOXTNBSSHBASSINFO 	AS B 
		                ON  A.BSSH_ESNTL_ID = B.BSSH_ESNTL_ID
		        WHERE 	1=1
		          AND 	A.ESNTL_ID=#esntlId# 
		          LIMIT 1
       ]]>
    </select>
    
    <select id="foxBsshInfoManageDAO.selectBsshEsntlId" parameterClass="java.lang.String" resultClass="foxBsshInfoManageVO">
       <![CDATA[
		       SELECT 	A.BSSH_ESNTL_ID  	AS    bsshEsntlId
		       		,	B.MTLTY_NM  		AS    mtltyNm
		         FROM	FOXTNMBERBSSHMAPNG 		AS A 
		                JOIN FOXTNBSSHBASSINFO 	AS B 
		                ON  A.BSSH_ESNTL_ID = B.BSSH_ESNTL_ID
		        WHERE 	1=1
		          AND 	A.ESNTL_ID=#esntlId# 
		          LIMIT 1
       ]]>
    </select>
    
    <select id="foxBsshInfoManageDAO.selectBsshInfo" resultClass="foxBsshInfoManageVO">
        <![CDATA[
            SELECT
                 BSSH_ESNTL_ID  	AS    bsshEsntlId
				,CTGRY_ID   		AS    ctgryId
				,BRTC_CODE   		AS    brtcCode
				,SIGNGU_CODE   		AS    signguCode
				,DONG_CODE   		AS    dongCode
				,MTLTY_NM   		AS    mtltyNm
				,BSSH_CMPGN_WORDS   AS    bsshCmpgnWords
				,BSSH_INTRCN_CN    	AS    bsshIntrcnCn
				,BSSH_PHOTO_ID   	AS    bsshPhotoId
				,BSN_BEGIN_TIME   	AS    bsnBeginTime
				,BSN_END_TIME   	AS    bsnEndTime
				,TLPHON_NO   		AS    tlphonNo
				,MOBLPHON_NO   		AS    moblphonNo
				,POST_NO   			AS    postNo
				,ADRES   			AS    adres
				,DETAIL_ADRES   	AS    detailAdres
				,BULD_NM   			AS    buldNm
				,BSN_STTUS   		AS    bsnSttus
				,COPRTN_STTUS   	AS    coprtnSttus
				,PREFER_CO   		AS    preferCo
				,POSTSCRIPT_CO   	AS    postscriptCo
				,FRST_REGIST_PNTTM  AS 	  frstRegistPnttm
				,FRST_REGISTER_ID  	AS 	  frstRegisterId
				,LAST_UPDT_PNTTM  	AS 	  lastUpdtPnttm
				,LAST_UPDUSR_ID  	AS    lastUpduseId
            FROM FOXTNBSSHBASSINFO
           WHERE 1=1
             AND BSSH_ESNTL_ID=#bsshEsntlId#
        ]]>
    </select>
    
     <update id="foxBsshInfoManageDAO.updateBsshInfo" parameterClass="foxBsshInfoManageVO">
            <![CDATA[
            UPDATE FOXTNBSSHBASSINFO 
            SET LAST_UPDUSR_ID = #esntlId#, 
             ]]>
                <isNotEmpty property="ctgryId">
                	CTGRY_ID        = #ctgryId#,
                </isNotEmpty>
                <isNotEmpty property="brtcCode">
	                BRTC_CODE       = #brtcCode#,
                </isNotEmpty>
                <isNotEmpty property="signguCode">
	                SIGNGU_CODE     = #signguCode#,
                </isNotEmpty>
                <isNotEmpty property="dongCode">
	                DONG_CODE       = #dongCode#,
                </isNotEmpty>
                <isNotEmpty property="mtltyNm">
	                MTLTY_NM      	= #mtltyNm#,
                </isNotEmpty>
                <isNotEmpty property="bsshCmpgnWords">
	                BSSH_CMPGN_WORDS= #bsshCmpgnWords#,
                </isNotEmpty>
                <isNotEmpty property="bsshIntrcnCn">
	                BSSH_INTRCN_CN  = #bsshIntrcnCn#,
                </isNotEmpty>
                <isNotEmpty property="bsshPhotoId">
	                BSSH_PHOTO_ID 	= #bsshPhotoId#,
                </isNotEmpty>
                <isNotEmpty property="bsnBeginTime">
	                BSN_BEGIN_TIME  = #bsnBeginTime#,
                </isNotEmpty>
                <isNotEmpty property="bsnEndTime">
	                BSN_END_TIME    = #bsnEndTime#,
                </isNotEmpty>
                <isNotEmpty property="tlphonNo">
	                TLPHON_NO    	= #tlphonNo#,
                </isNotEmpty>
                <isNotEmpty property="moblphonNo">
	                MOBLPHON_NO    	= #moblphonNo#,
                </isNotEmpty>
                <isNotEmpty property="postNo">
	                POST_NO    		= #postNo#,
                </isNotEmpty>
                <isNotEmpty property="adres">
	                ADRES    		= #adres#,
                </isNotEmpty>
                <isNotEmpty property="detailAdres">
	                DETAIL_ADRES    = #detailAdres#,
                </isNotEmpty>
                <isNotEmpty property="bsnEndTime">
	                BSN_END_TIME    = #bsnEndTime#,
                </isNotEmpty>
                <isNotEmpty property="buldNm">
	                BULD_NM    		= #buldNm#,
                </isNotEmpty>
                <isNotEmpty property="bsnSttus">
	                BSN_STTUS    	= #bsnSttus#,
                </isNotEmpty>
            <![CDATA[
            	LAST_UPDT_PNTTM = sysdate()
            WHERE 1=1
              AND BSSH_ESNTL_ID=#bsshEsntlId#
            ]]>
    </update>
    
     <update id="foxBsshInfoManageDAO.updateBsnBassInfo" parameterClass="foxBsshInfoManageVO">
            <![CDATA[
            UPDATE FOXTNBSSHBASSINFO 
            SET LAST_UPDUSR_ID = #esntlId#, 
             ]]>
                <isNotEmpty property="bsshCmpgnWords">
	                BSSH_CMPGN_WORDS= #bsshCmpgnWords#,
                </isNotEmpty>
                <isNotEmpty property="bsshIntrcnCn">
	                BSSH_INTRCN_CN  = #bsshIntrcnCn#,
                </isNotEmpty>
                <isNotEmpty property="bsshPhotoId">
	                BSSH_PHOTO_ID 	= #bsshPhotoId#,
                </isNotEmpty>
                <isNotEmpty property="bsnBeginTime">
	                BSN_BEGIN_TIME  = #bsnBeginTime#,
                </isNotEmpty>
                <isNotEmpty property="bsnEndTime">
	                BSN_END_TIME    = #bsnEndTime#,
                </isNotEmpty>
            <![CDATA[
            	LAST_UPDT_PNTTM = sysdate()
            WHERE 1=1
              AND BSSH_ESNTL_ID=#bsshEsntlId#
            ]]>
    </update>
    
    <update id="foxBsshInfoManageDAO.updateCoprtnSttus" parameterClass="foxBsshInfoManageVO">
           <![CDATA[
	           UPDATE FOXTNBSSHBASSINFO 
	              SET COPRTN_STTUS = #coprtnSttus#
	            WHERE 1=1
	              AND BSSH_ESNTL_ID=#bsshEsntlId#
           ]]>
    </update>  
    
    <update id="foxBsshInfoManageDAO.updatePostscriptCo" parameterClass="foxBsshInfoManageVO">
           <![CDATA[
	           UPDATE FOXTNBSSHBASSINFO 
	              SET POSTSCRIPT_CO = POSTSCRIPT_CO + 1
	            WHERE 1=1
	              AND BSSH_ESNTL_ID=#bsshEsntlId#
           ]]>
    </update>
    
    <update id="foxBsshInfoManageDAO.updatePreferCo" parameterClass="foxBsshInfoManageVO">
           <![CDATA[
	           UPDATE FOXTNBSSHBASSINFO 
	              SET PREFER_CO = PREFER_CO + 1
	            WHERE 1=1
	              AND BSSH_ESNTL_ID=#bsshEsntlId#
           ]]>
    </update>
    
        
	 <select id="foxBsshInfoManageDAO.selectBsshInfoList" parameterClass="foxBsshInfoDefaultVO" resultClass="egovMap">
		SELECT 
		      bsshEsntlId, ctgryId, brtcCode , signguCode, dongCode, mtltyNm, bsshCmpgnWords, bsshIntrcnCn, bsshPhotoId, bsnBeginTime, bsnEndTime
		    , tlphonNo ,moblphonNo ,postNo ,adres ,detailAdres ,buldNm ,bsnSttus ,coprtnSttus ,coprtnSttus ,preferCo , postscriptCo
		    , frstRegistPnttm ,frstRegisterId , lastUpdtPnttm ,lastUpduseId
		FROM(
		    SELECT 
                 BSSH_ESNTL_ID  	AS    bsshEsntlId
				,CTGRY_ID   		AS    ctgryId
				,BRTC_CODE   		AS    brtcCode
				,SIGNGU_CODE   		AS    signguCode
				,DONG_CODE   		AS    dongCode
				,MTLTY_NM   		AS    mtltyNm
				,BSSH_CMPGN_WORDS   AS    bsshCmpgnWords
				,BSSH_INTRCN_CN    	AS    bsshIntrcnCn
				,BSSH_PHOTO_ID   	AS    bsshPhotoId
				,BSN_BEGIN_TIME   	AS    bsnBeginTime
				,BSN_END_TIME   	AS    bsnEndTime
				,TLPHON_NO   		AS    tlphonNo
				,MOBLPHON_NO   		AS    moblphonNo
				,POST_NO   			AS    postNo
				,ADRES   			AS    adres
				,DETAIL_ADRES   	AS    detailAdres
				,BULD_NM   			AS    buldNm
				,BSN_STTUS   		AS    bsnSttus
				,COPRTN_STTUS   	AS    coprtnSttus
				,PREFER_CO   		AS    preferCo
				,POSTSCRIPT_CO   	AS    postscriptCo
				,FRST_REGIST_PNTTM  AS 	  frstRegistPnttm
				,FRST_REGISTER_ID  	AS 	  frstRegisterId
				,LAST_UPDT_PNTTM  	AS 	  lastUpdtPnttm
				,LAST_UPDUSR_ID  	AS    lastUpduseId
		    FROM FOXTNBSSHBASSINFO
		    ) A
		        WHERE 1=1
		          AND BSN_STTUS != '99'
		        <isNotEmpty prepend="AND" property="ctgryId">
	                CTGRY_ID    = #ctgryId#
                </isNotEmpty>
		        <isNotEmpty prepend="AND" property="brtcCode">
		            BRTC_CODE LIKE #brtcCode#
		        </isNotEmpty>
		        <isNotEmpty prepend="AND" property="signguCode">
		            SIGNGU_CODE LIKE #signguCode#
		        </isNotEmpty>
		        <isNotEmpty prepend="AND" property="dongCode">
		            DONG_CODE LIKE #dongCode#
		        </isNotEmpty>
		        <isNotEmpty prepend="AND" property="mtltyNm">
		            MTLTY_NM LIKE '%' #mtltyNm# '%'
		        </isNotEmpty>
		        ORDER BY BSSH_ESNTL_ID DESC
		        LIMIT #recordCountPerPage# OFFSET #firstIndex#
	    </select>
    
    
        <select id="foxBsshInfoManageDAO.selectBsshInfoListTotCnt" parameterClass="foxBsshInfoDefaultVO" resultClass="int">
             <![CDATA[
		            SELECT 
		                ESNTL_ID               bsshEsntlId
		            FROM FOXTNBSSHBASSINFO
	        		WHERE 1=1
			          AND BSN_STTUS != '99'
                ]]>
    	</select>
    
   
     <update id="foxBsshInfoManageDAO.deleteBsshInfo" parameterClass="foxBsshInfoManageVO">
           <![CDATA[
	           UPDATE FOXTNBSSHBASSINFO 
	              SET BSN_STTUS = '99'
	            WHERE 1=1
	              AND BSSH_ESNTL_ID=#bsshEsntlId#
           ]]>
    </update>
    
</sqlMap>
